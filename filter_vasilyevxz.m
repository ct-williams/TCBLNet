function Uf = filter_vasilyevxz(U,nx,ny,nz,index)
Uf = zeros(nx,ny,nz);

if(index==1)

       Uf(4:nx-3,:,:) = -1/32*U(1:nx-6,:,:) + 9/32*U(3:nx-4,:,:) + 1/2*U(4:nx-3,:,:) + ...
              9/32*U(5:nx-2,:,:) + -1/32*U(7:nx,:,:);
    
    
       Uf(3,:,:) = -1/32*U(end,:,:) + 9/32*U(2,:,:) + 1/2*U(3,:,:) + ...
              9/32*U(4,:,:) + -1/32*U(6,:,:);
    
    
       Uf(2,:,:) = -1/32*U(end-1,:,:) + 9/32*U(1,:,:) + 1/2*U(2,:,:) + ...
              9/32*U(3,:,:) + -1/32*U(5,:,:);
    
       Uf(1,:,:) = -1/32*U(end-2,:,:) + 9/32*U(end,:,:) + 1/2*U(1,:,:) + ...
              9/32*U(2,:,:) + -1/32*U(4,:,:);
    
    
       Uf(nx-2,:,:) = -1/32*U(nx-5,:,:) + 9/32*U(nx-3,:,:) + 1/2*U(nx-2,:,:) + ...
              9/32*U(nx-1,:,:) + -1/32*U(1,:,:);
    
    
       Uf(nx-1,:,:) = -1/32*U(nx-4,:,:) + 9/32*U(nx-2,:,:) + 1/2*U(nx-1,:,:) + ...
              9/32*U(nx,:,:) + -1/32*U(2,:,:);
   
       Uf(nx,:,:) = -1/32*U(nx-3,:,:) + 9/32*U(nx-1,:,:) + 1/2*U(nx,:,:) + ...
              9/32*U(1,:,:) + -1/32*U(3,:,:);
   
    
elseif(index==3)
        
     Uf(:,:,4:nz-3) = -1/32*U(:,:,1:nz-6) + 9/32*U(:,:,3:nz-4) + 1/2*U(:,:,4:nz-3) + ...
              9/32*U(:,:,5:nz-2) + -1/32*U(:,:,7:nz);
    
     Uf(:,:,3) = -1/32*U(:,:,end) + 9/32*U(:,:,2) + 1/2*U(:,:,3) + ...
              9/32*U(:,:,4) + -1/32*U(:,:,6);
    
     Uf(:,:,2) = -1/32*U(:,:,end-1) + 9/32*U(:,:,1) + 1/2*U(:,:,2) + ...
              9/32*U(:,:,3) + -1/32*U(:,:,5);
   
     Uf(:,:,1) = -1/32*U(:,:,end-2) + 9/32*U(:,:,end) + 1/2*U(:,:,1) + ...
              9/32*U(:,:,2) + -1/32*U(:,:,4);
    
     Uf(:,:,nz-2) = -1/32*U(:,:,nz-5) + 9/32*U(:,:,nz-3) + 1/2*U(:,:,nz-2) + ...
              9/32*U(:,:,nz-1) + -1/32*U(:,:,1);
    
    
    Uf(:,:,nz-1) = -1/32*U(:,:,nz-4) + 9/32*U(:,:,nz-2) + 1/2*U(:,:,nz-1) + ...
              9/32*U(:,:,nz) + -1/32*U(:,:,2);
    
    
        Uf(:,:,nz) = -1/32*U(:,:,nz-3) + 9/32*U(:,:,nz-2) + 1/2*U(:,:,nz) + ...
              9/32*U(:,:,1) + -1/32*U(:,:,3);
   
 end

end
