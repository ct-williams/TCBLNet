function Uf = filter_vasilyevy(U,nx,ny,nz,index)
Uf = zeros(nx,ny,nz);
if(index==1 || index==3)  
    for i = 4 : ny -3 
        Uf(:,i,:) = -1/32*U(:,i-3,:) + 9/32*U(:,i-1,:) + 1/2*U(:,i,:) + ...
              9/32*U(:,i+1,:) + -1/32*U(:,i+3,:);
    end
    for i = 3 
        Uf(:,i,:) = -1*-1/32*U(:,2,:) + 9/32*U(:,i-1,:) + 1/2*U(:,i,:) + ...
              9/32*U(:,i+1,:) + -1/32*U(:,i+3,:);
%         Uf(:,i,:) = -1*-1/32*U(:,1,:) + 9/32*U(:,i-1,:) + 1/2*U(:,i,:) + ...
%               9/32*U(:,i+1,:) + -1/32*U(:,i+3,:);
    end
    for i = 2 
        Uf(:,i,:) = -1*-1/32*U(:,3,:) + 9/32*U(:,1,:) + 1/2*U(:,i,:) + ...
              9/32*U(:,i+1,:) + -1/32*U(:,i+3,:);
%         Uf(:,i,:) = -1*-1/32*U(:,2,:) + 9/32*U(:,1,:) + 1/2*U(:,i,:) + ...
%               9/32*U(:,i+1,:) + -1/32*U(:,i+3,:);
    end
    for i = 1 
        Uf(:,i,:) = -1*-1/32*U(:,4,:) + -9/32*U(:,2,:) + 1/2*U(:,i,:) + ...
              9/32*U(:,i+1,:) + -1/32*U(:,i+3,:);
%         Uf(:,i,:) = -1*-1/32*U(:,3,:) + -9/32*U(:,1,:) + 1/2*U(:,i,:) + ...
%               9/32*U(:,i+1,:) + -1/32*U(:,i+3,:);
    end
    
    for i = ny-2 
        Uf(:,i,:) = -1/32*U(:,i-3,:) + 9/32*U(:,i-1,:) + 1/2*U(:,i,:) + ...
              9/32*U(:,i+1,:) + -1*-1/32*U(:,end-1,:);
%         Uf(:,i,:) = -1/32*U(:,i-3,:) + 9/32*U(:,i-1,:) + 1/2*U(:,i,:) + ...
%               9/32*U(:,i+1,:) + -1*-1/32*U(:,end,:);
    end
    for i = ny-1 
        Uf(:,i,:) = -1/32*U(:,i-3,:) + 9/32*U(:,i-1,:) + 1/2*U(:,i,:) + ...
              9/32*U(:,i+1,:) + -1*-1/32*U(:,ny-2,:);
%         Uf(:,i,:) = -1/32*U(:,i-3,:) + 9/32*U(:,i-1,:) + 1/2*U(:,i,:) + ...
%               9/32*U(:,i+1,:) + -1*-1/32*U(:,ny-1,:);
    end
    for i = ny 
        Uf(:,i,:) = -1/32*U(:,i-3,:) + 9/32*U(:,i-1,:) + 1/2*U(:,i,:) + ...
              -9/32*U(:,ny-1,:) + -1*-1/32*U(:,ny-3,:);
%         Uf(:,i,:) = -1/32*U(:,i-3,:) + 9/32*U(:,i-1,:) + 1/2*U(:,i,:) + ...
%               -9/32*U(:,ny,:) + -1*-1/32*U(:,ny-2,:);
    end
   
elseif(index==2)
        
    for i = 4 : ny -3 
        Uf(:,i,:) = -1/32*U(:,i-3,:) + 9/32*U(:,i-1,:) + 1/2*U(:,i,:) + ...
              9/32*U(:,i+1,:) + -1/32*U(:,i+3,:);
    end
    for i = 3 
        Uf(:,i,:) = 1*-1/32*U(:,2,:) + 9/32*U(:,i-1,:) + 1/2*U(:,i,:) + ...
              9/32*U(:,i+1,:) + -1/32*U(:,i+3,:);
%         Uf(:,i,:) = 1*-1/32*U(:,1,:) + 9/32*U(:,i-1,:) + 1/2*U(:,i,:) + ...
%               9/32*U(:,i+1,:) + -1/32*U(:,i+3,:);
    end
    for i = 2 
        Uf(:,i,:) = 1*-1/32*U(:,3,:) + 9/32*U(:,1,:) + 1/2*U(:,i,:) + ...
              9/32*U(:,i+1,:) + -1/32*U(:,i+3,:);
%         Uf(:,i,:) = 1*-1/32*U(:,2,:) + 9/32*U(:,1,:) + 1/2*U(:,i,:) + ...
%               9/32*U(:,i+1,:) + -1/32*U(:,i+3,:);
    end
    for i = 1 
        Uf(:,i,:) = -1*1/32*U(:,4,:) + 9/32*U(:,2,:) + 1/2*U(:,i,:) + ...
              9/32*U(:,i+1,:) + -1/32*U(:,i+3,:);
%         Uf(:,i,:) = 1*-1/32*U(:,3,:) + 9/32*U(:,1,:) + 1/2*U(:,i,:) + ...
%               9/32*U(:,i+1,:) + -1/32*U(:,i+3,:);
    end
    
    for i = ny-2 
        Uf(:,i,:) = -1/32*U(:,i-3,:) + 9/32*U(:,i-1,:) + 1/2*U(:,i,:) + ...
              9/32*U(:,i+1,:) + 1*-1/32*U(:,end-1,:);
%         Uf(:,i,:) = -1/32*U(:,i-3,:) + 9/32*U(:,i-1,:) + 1/2*U(:,i,:) + ...
%               9/32*U(:,i+1,:) + 1*-1/32*U(:,end,:);
    end
    for i = ny-1 
        Uf(:,i,:) = -1/32*U(:,i-3,:) + 9/32*U(:,i-1,:) + 1/2*U(:,i,:) + ...
              9/32*U(:,i+1,:) + 1*-1/32*U(:,ny-2,:);
%         Uf(:,i,:) = -1/32*U(:,i-3,:) + 9/32*U(:,i-1,:) + 1/2*U(:,i,:) + ...
%               9/32*U(:,i+1,:) + 1*-1/32*U(:,ny-1,:);
    end
    for i = ny 
        Uf(:,i,:) = -1/32*U(:,i-3,:) + 9/32*U(:,i-1,:) + 1/2*U(:,i,:) + ...
              9/32*U(:,ny-1,:) + 1*-1/32*U(:,ny-3,:);
%           Uf(:,i,:) = -1/32*U(:,i-3,:) + 9/32*U(:,i-1,:) + 1/2*U(:,i,:) + ...
%               9/32*U(:,ny,:) + 1*-1/32*U(:,ny-2,:);
    end
end

end
